<!--@ Felix 2026-->


<!DOCTYPE html>
<html>
<head>
    <title>JOIN Demo - PesapalDB</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 1400px; margin: auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        .btn { display: inline-block; padding: 10px 15px; margin: 5px; background: #3498db; color: white; text-decoration: none; border-radius: 5px; }
        .btn.active { background: #2c3e50; }
        .btn:hover { background: #2980b9; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background-color: #f2f2f2; position: sticky; top: 0; }
        tr:hover { background-color: #f9f9f9; }
        .stats { display: flex; gap: 20px; margin: 20px 0; padding: 15px; background: #e8f4fc; border-radius: 5px; }
        .stat-box { flex: 1; text-align: center; padding: 15px; background: white; border-radius: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .sql-demo { background: #f8f9fa; padding: 15px; border-left: 4px solid #3498db; margin: 20px 0; }
        .error { color: red; padding: 20px; background: #ffe6e6; border-radius: 5px; }
        .null-cell { color: #999; font-style: italic; }
        .users-col { background: #e8f6ff; }
        .orders-col { background: #fff0e8; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìä JOIN Operation Demo</h1>
        <a href="/" class="btn">üè† Home</a>
        <a href="/terminal/" class="btn">üíª SQL Terminal</a>
        
        {% if error %}
        <div class="error">
            <h3>Error:</h3>
            <p>{{ error }}</p>
        </div>
        {% else %}
        
        <div class="stats">
            <div class="stat-box">
                <h3>JOIN Type</h3>
                <h2>{{ join_type }} JOIN</h2>
            </div>
            <div class="stat-box">
                <h3>Total Rows</h3>
                <h2>{{ total_rows }}</h2>
            </div>
            <div class="stat-box">
                <h3>Users with Orders</h3>
                <h2>{{ users_with_orders }}</h2>
            </div>
            <div class="stat-box">
                <h3>Orders with Users</h3>
                <h2>{{ orders_with_users }}</h2>
            </div>
        </div>
        
        <h3>Try Different JOIN Types:</h3>
        <div>
            {% for type in join_types %}
            <a href="?type={{ type }}" class="btn {% if type == join_type %}active{% endif %}">
                {{ type }} JOIN
            </a>
            {% endfor %}
        </div>
        
        <div class="sql-demo">
            <h3>SQL Equivalent:</h3>
            <pre>SELECT * 
FROM users 
{{ join_type }} JOIN orders ON users.id = orders.user_id</pre>
            
            <h3>What This Means:</h3>
            <ul>
                {% if join_type == 'INNER' %}
                <li>Returns only users who have orders AND orders that have users</li>
                <li>Excludes: Users without orders AND orders without users</li>
                {% elif join_type == 'LEFT' %}
                <li>Returns ALL users, with their orders if they have any</li>
                <li>Users without orders appear with NULL order columns</li>
                {% elif join_type == 'RIGHT' %}
                <li>Returns ALL orders, with their users if they exist</li>
                <li>Orders without users appear with NULL user columns</li>
                {% elif join_type == 'FULL' %}
                <li>Returns ALL users AND ALL orders</li>
                <li>Missing matches appear as NULLs</li>
                {% elif join_type == 'CROSS' %}
                <li>Returns EVERY combination of users and orders</li>
                <li>No relationship needed - just all possible pairs</li>
                {% endif %}
            </ul>
        </div>
        
        <h3>Results ({{ results|length }} rows):</h3>
        {% if results %}
        <div style="overflow-x: auto; max-height: 500px; overflow-y: auto;">
            <table>
                <thead>
                    <tr>
                        <!-- Dynamically generate headers -->
                        {% for key in results.0.keys %}
                        <th class="{% if 'users.' in key %}users-col{% elif 'orders.' in key %}orders-col{% endif %}">
                            {{ key }}
                        </th>
                        {% endfor %}
                    </tr>
                </thead>
                <tbody>
                    {% for row in results %}
                    <tr>
                        {% for key, value in row.items %}
                        <td class="{% if value is None %}null-cell{% endif %}">
                            {% if value is None %}
                            NULL
                            {% else %}
                            {{ value }}
                            {% endif %}
                        </td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <p>No results found.</p>
        {% endif %}
        
        <h3>Sample Data Overview:</h3>
        <div style="display: flex; gap: 20px; margin: 20px 0;">
            <div style="flex: 1;">
                <h4>üë• Users Table</h4>
                <ul>
                    <li>Alice Johnson (ID: 1)</li>
                    <li>Bob Smith (ID: 2)</li>
                    <li>Charlie Brown (ID: 3)</li>
                    <li>Diana Prince (ID: 4)</li>
                </ul>
            </div>
            <div style="flex: 1;">
                <h4>üõí Orders Table</h4>
                <ul>
                    <li>Order 1: Laptop (User: 1)</li>
                    <li>Order 2: Mouse (User: 1)</li>
                    <li>Order 3: Keyboard (User: 2)</li>
                    <li>Order 4: Monitor (User: 2)</li>
                    <li>Order 5: Headphones (User: 5) ‚Üê User doesn't exist!</li>
                </ul>
            </div>
        </div>
        {% endif %}
    </div>
</body>
</html>